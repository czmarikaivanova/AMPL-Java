% This is a general template file for the LaTeX package SVJour3
% for Springer journals.          Springer Heidelberg 2010/09/16
%
% Copy it to a new file with a new name and use it as the basis
% for your article. Delete % signs as needed.
%
% This template includes a few options for different layouts and
% content for various journals. Please consult a previous issue of
% your journal as needed.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% First comes an example EPS file -- just ignore it and
% proceed on the \documentclass line
% your LaTeX will extract the file if required
\begin{filecontents*}{example.eps}
%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 19 19 221 221
%%CreationDate: Mon Sep 29 1997
%%Creator: programmed by hand (JK)
%%EndComments
gsave
newpath
  20 20 moveto
  20 220 lineto
  220 220 lineto
  220 20 lineto
closepath
2 setlinewidth
gsave
  .4 setgray fill
grestore
stroke
grestore
\end{filecontents*}
%
\RequirePackage{fix-cm}
%
%\documentclass{svjour3}                     % onecolumn (standard format)
%\documentclass[smallcondensed]{svjour3}     % onecolumn (ditto)
\documentclass[smallextended]{svjour3}       % onecolumn (second format)
%\documentclass[twocolumn]{svjour3}          % twocolumn
%
\smartqed  % flush right qed marks, e.g. at end of proof
%
\usepackage{graphicx}
\usepackage{tkz-graph}
\usepackage{amsmath, amssymb}
\usepackage{graphicx}
\usepackage{tikz}
\usepackage{amsfonts}
\usepackage{subcaption}
\usepackage{hyperref}
%\usepackage{pdflscape} % Landscape pages
\usepackage{color}	% Different font colors
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{mathtools}
\usepackage{color}

\captionsetup{compatibility=false}

\newtheorem{observation}[theorem]{\textbf{Observation}}

\tikzset{
every edge/.style={fill=none} 
every node/.style={shape=circle,fill=gray!40,draw }}



%\newtheorem{proposition}{Proposition}
%\newtheorem{obsservation}{Observation}
%\newtheorem{corollary}{Corollary}
%newtheorem{lemma}{Lemma}
%\newtheorem{problem}{Problem}
%
% \usepackage{mathptmx}      % use Times fonts if available on your TeX system
%
% insert here the call for the packages your document requires
%\usepackage{latexsym}
% etc.
%
% please place your own definitions here and don't use \def but
% \newcommand{}{}
%
% Insert the name of "your journal" with
% \journalname{myjournal}
%
\begin{document}

\title{Insert your title here%\thanks{Grants or other notes
%about the article that should go on the front page should be
%placed here. General acknowledgments should be placed at the end of the article.}
}
\subtitle{Do you have a subtitle?\\ If so, write it here}

%\titlerunning{Short form of title}        % if too long for running head

\author{First Author         \and
        Second Author %etc.
}

%\authorrunning{Short form of author list} % if too long for running head

\institute{F. Author \at
              first address \\
              Tel.: +123-45-678910\\
              Fax: +123-45-678910\\
              \email{fauthor@example.com}           %  \\
%             \emph{Present address:} of F. Author  %  if needed
           \and
           S. Author \at
              second address
}

\date{Received: date / Accepted: date}
% The correct dates will be entered by the editor


\maketitle

\begin{abstract}
\keywords{}
% \PACS{PACS code1 \and PACS code2 \and more}
% \subclass{MSC code1 \and MSC code2 \and more}
\end{abstract}

\section{Introduction}
\label{intro}
The minimum broadcast time consists of a set of communication nodes with a subset of source nodes. 
The task is to disseminate a signal to every node in a shortest possible time while abiding by communication rules.
An \emph{informed} node is a node that has received the signal.
Otherwise, a node is \emph{uninformed}.
At the beginning, the set of informed nodes is exactly the set of sources.
An informed node $u$ can send the signal to a uninformed node $v$ if $u$ and $v$ are located within a communication vicinity of each other.

The continuous time is divided into discrete time steps.
At each time step, every informed node can forward the signal to at most one uninformed neighbor.
The number of informed nodes at some time step can therefore be up to double the number of informed nodes at the previous time step.
%\subsection{Motivation and Related Work}
%This communication protocol differs from various wireless communication models where a signal can be relayed to all nodes within a visibility range of a sender.
%An example of a practical application is a communication among processors.
%The applications are however not confined to wired networks.
%Situations where the signals have to cover large distances typically assume sending the signal to one neighbor at a time.
%This is common in satellite communication.
%
\section{Network Model and Notation}

The communication network is represented by an undirected unweighted graph $G=(V,E)$ and a subset of nodes $S\subseteq V$. 
Broadcasting is defined as a sequence of sets $S=V_0\subseteq\dots\subseteq V_k = V$ where each $V_i$ represents the nodes informed after time step $i$, $0\leq i\leq k$.
For each node $v\in V_i\setminus V_{i-1}$, there exists a single node $p(v)\in V_{i-1}$ adjacent to $v$, which forwarded the signal to $v$.
Also, for every two distinct nodes $u,v\in V_i\setminus V_{i-1}$ we have $p(u)\neq p(v)$.
The optimization problem in question is defined as follows:
\begin{problem}\label{prob:min}
Given $G=(V,E)$ and $S\subseteq V$, find a sequence $S=V_0\subseteq\dots\subseteq V_k=V$ of minimum lenght $k$ 
and a mapping $p:V\setminus S\to V$, such that for each $v\in V\setminus S:\{v,p(v)\}\in E$, and for each $u,v\in V_i\setminus V_{i-1}: p(u)\neq p(v)\Leftrightarrow u\neq v$.
\end{problem}
For convenience, we define the set $A=\{(i,j),(j,i):\{i,j\}\in E\}$ that consists of all arcs that can be derived by directing edges in $E$.
The set of neighbors of $v\in V$ in $G$ is denoted as $N(v)$.
\section{Exact methods}

Problem \ref{prob:min} can be formulated as an integer linear program and solved to optimality. In this section, we present two different modeling approaches. 

\subsection{Broadcast time model}
The first studied model is a straightforward formulation of the problem.
Consider variables 
$$ x_{ij}^t=
\begin{cases} 
1, \text{ if } j\in V_t \text{ and } p(j)=i,\\ 
0, \text{ otherwise},
\end{cases}
$$
and a variable $c$ representing the number of necessary time steps.
The worst case scenario is when $G$ is a path $v_1,\dots,v_n$ with $S=\{v_1\}$. 
In such an instance, the necessary number of time steps is $n-1$, which gives a trivial upper bound on $c$.
Problem \ref{prob:min} is then formulated as follows: 

\begin{subequations}\label{mod:basic}
\begin{align}
\label{mod:basic:obj} \min c \\ 
\label{mod:basic:onefromroot} \sum_{i \in N(s)}x^1_{si} & \leq 1 & s\in S,\\
\label{mod:basic:singlein} \sum\limits_{t=1}^{n-1}\sum\limits_{j\in N(i)}x_{ji}^t & = 1 & i\in V \setminus S,\\
\label{mod:basic:uniqueTout} \sum\limits_{j\in N(i)}x_{ij}^t & \leq 1  & t=1,\dots,n-1,i\in V,\\
\label{mod:basic:tIncreases} \sum\limits_{j\in N(i)}x_{ij}^t &\leq\sum\limits_{u=1}^{t-1}\sum\limits_{k\in N(i)\setminus\{j\}} x_{ki}^u  & i\in V\setminus S, t=2,\dots,n-1,\\
\label{mod:basic:tcrel} \sum\limits_{t=1}^{n-1}t\sum\limits_{j\in N(i)}x_{ij}^t & \leq c &  i\in V,\\
\label{mod:basic:positiveCost}x_{ij}^1 & = 0 & (i,j)\in A, i \not\in S,\\
\label{mod:basic:dim}&&x \in \{0,1\}^{A\times V}, c \in\{1,\dots,n-1\}.
\end{align}~
\end{subequations}

Constraints \eqref{mod:basic:onefromroot} indicate that source nodes transmit in the first time step.
By \eqref{mod:basic:singlein}, all non-source nodes have a single predecessor.
Constraints \eqref{mod:basic:uniqueTout} enforce that each node transmits the signal to at most one neighbor at each time step.
The requirement that only informed nodes can relay a signal is modeled by \eqref{mod:basic:tIncreases}. 
The maximum time step at which any transmission takes place is captured by \eqref{mod:basic:tcrel}, and finally, \eqref{mod:basic:positiveCost} states that a node that is not a source never transmits in the first time step.

\subsection{Binomial tree model}

The following method solves Problem \ref{prob:min} by solving a sequence of decision problems:
\begin{problem}
\label{prob:dec}
Given $G=(V,E)$, $S\subseteq V$ and $k\in \mathbb{N}$, is there a sequence $S=V_0\subseteq\dots\subseteq V_k=V$ 
and a mapping $p:V\setminus S\to V$, such that for each $v\in V\setminus S:\{v,p(v)\}\in E$ and for each  $u,v\in V_i\setminus V_{i-1}: p(u)\neq p(v)\Leftrightarrow u\neq v$?
\end{problem}
For a deadline $k$, at most $|S|\cdot 2^k$ nodes can be informed within $k$ steps. 
%Therefore, we assume $n\leq 2^k|S|.
This can be achieved when arcs along which signals initiated at sources $s\in S$ are transmitted form binomial trees $B^k$ of order $k$ rooted at $s$.
Hence, if there is a partition of $G$ into $|S|$ truncated binomial trees of order at most $k$ rooted at sources, then $(G,S,k)$ is a YES instance of Problem \ref{prob:dec}.
Finding a partition of $G$ into $|S|$ truncated binomial trees can be equivalently formulated as finding a partition of $G$ into $|S|$ (complete) binomial trees in $G''$ constructed from $G$ as follows:
Let $\alpha\coloneqq |S|\cdot 2^k-|V|$, and let $K_\alpha=(V_\alpha,E_\alpha)$ be a complete graph on $\alpha$ nodes.
Each node in $K_\alpha$ is connected to every node $v\in V$ in the original graph $G$.
Thus, $G''=(V'',E'')$ with $V''=V\cup V_\alpha$ and $E''=E\cup E_\alpha\cup \{\{u,v\}: u\in V \wedge v\in V_\alpha\}$.
The set of arcs $A''$ is constructed by creating two arcs of opposite orientation for each edge, but arcs with orientation from $V_\alpha$ to $V$ are excluded. 
Formally, $A''=A\cup\{(u,v),(v,u): \{u,v\}\in E_\alpha\}\cup\{(u,v):u\in V \wedge v\in V_\alpha\}$.

Let $I=\{1,\dots,2^k\}$.
For a directed rooted binomial tree $B^k=(V^k,A^k)$, we define a systematic numbering of nodes in $V^k$, so that a node number determines a unique position in $B^k$.
I.e., we need a bijective mapping $\beta: V^k \to I$.
A suitable mapping $\beta$ assigns values increasingly with decreasing outgoing degree. 
If there is an ambiguity, a node whose parent has a lower number is assigned a lower number.
This mapping is defined recursively as
\begin{equation}
\label{eq:beta}
\beta(v)=\begin{cases}
1,\text{ if } v\in S \text{ is a root of } B^k,\\
\beta(p(v)) + 2^{k-deg^+(v)-1}, \text{ otherwise}.
\end{cases}
\end{equation}
\begin{observation}\label{obs:deg}
For each $i\in\{1,\dots,k\}$, the set $\{v\in V^k: 1\leq\beta(v)\leq2^i\}\setminus\{v\in V^k:1\leq\beta(v)\leq2^{i-1}\}$ contains nodes with out-degree $k-i$.
\end{observation}
\begin{observation}\label{obs:childdeg}
Descendants of $v\in V^k$ with $deg^+(v)=l$ have out-degree $0,\dots,l-1$.
\end{observation}
\begin{proposition}\label{lem:probeq}
For an instance $(G,S,k)$ of Problem \ref{prob:dec}, all nodes in $G$ become informed within $k$ time steps iff 
there exists a partition of $G''$ into $|S|$ directed binomial trees $B^k_1,\dots,B^k_{|S|}$ of order $k$ rooted at sources in $S$,
such that for each $B^k_i=(V^k_i,A^k_i)$ we have that $A_i\cap\{(u,v):u \in V_\alpha \wedge v\in V^k_i\}=\emptyset$. 
\end{proposition}
\begin{proof}
Assume there are directed rooted binomial trees $B^k_1,\dots B^k_{|S|}$ covering $V''$. 
Nodes in $V$ are divided into a sequence of subsets $S=V_0\subseteq\dots\subseteq V_k=V$ such that $V_i=\{v\in V:1\leq\beta(v)\leq 2^i\}$,
and $p(v)=u$ is a parent of $v$ in a corresponding binomial tree.
For $u,v\in V_i\setminus V_{i-1}$ we have from \ref{obs:deg} that $deg^+(u)=deg^+(v)=k-i$.
Furthermore, $p(u)\neq p(v)$ must hold, because due to \ref{obs:childdeg} no node has two descendants with the same out-degree.
These observations can be applied because the mapping $p$ corresponds to arcs in binomial trees $B^k_1,\dots,B^k_{|S|}$. 

Conversely, suppose there is a sequence of subsets and a mapping $p$ in $G$ with the desired properties.
For $1\leq i\leq k$, $|V_i|\geq2|V_{i-1}|$ must hold, because otherwise $\forall u,v\in V_i:p(u)\neq p(v)\Leftrightarrow u\neq v$ could not be satisfied.
For some node $v\in V_i$, there is at most $k-i$ nodes $u$ such that $p(u)=v$.
Truncated binomial trees covering $G$ can then be constructed simply by following the mapping $p$.
The remaining arcs that complement binomial trees are distributed along $A''\setminus A$.
\qed
\end{proof}

The ILP model based on partition into binomial trees uses only one type of variables
$$
y_{is}^v=\begin{cases}
1, \text{ if  node } v \text{ is the } i\text{-th node of the binomial tree rooted at } s\in S,\\
0, \text{ otherwise},
\end{cases}
$$
where $v\in V''$ and $i\in I $. 
With the definition of $G''$ above, it is straightforward to specify constraints that enforce desired values for $y$-variables.
An obvious weakness of this approach is  that the number of nodes increases to $|V''|=\mathcal{O}(n|S|)$, and the dimension of variables is thus $\mathcal{O}(n^2|S|^2)$.
However, once a suitable partition is found, the arcs of binomial trees contained in $K_\alpha$ can be diversely shuffled while preserving the layour of binomial trees in $G$.
Instead of adding the entire complete graph $K_\alpha$, a single node $v_0$ with a loop $(v_0,v_0)$ is connected as an apex to the original $G$.
Let us denote this graph as $G'=(V',E')$, where $V'=V\cup\{v_0\}$, $E'=E\cup\{\{u,v_0\}:u\in V\}$. The arc set is then analogously defined as $A'=A\cup\{(u,v_0): u\in V\}$.
The requirement for partition into binomial trees has to be adjusted accordingly.
The subtrees contained in $G$ remain unchanged, every arc $(u,v)\in A_i, i=1,\dots,|S|$ in $G''$ with $u\in V$ and $v\in V_\alpha$ becomes $(u,v_0)$ in $G'$,
and every $(u,v)\in A_\alpha$ becomes $(v_0,v_0)$.
So, $v_0$ acts as a universal node that can substitute several nodes in each binomial tree.

Let us define the set $C(i)$ of $\beta$-values of children of node $v$ with $\beta(v)=i$ in $B^k$:
\begin{equation}
C(i)=\{2^l+i:l=\lceil\log_2 i\rceil,\dots,k-1\}.
\end{equation}
The values of the variables must fulfill constraints

\begin{subequations}\label{mod:partition}
\begin{align}
\label{mod:part:nodeBelongs} \sum\limits_{i\in I}\sum\limits_{s\in S}y^v_{is} & = 1 & v\in V,\\
\label{mod:part:treeHasIJ} \sum\limits_{v\in V'}y^v_{is} & = 1 & i\in I,s\in S,\\
\label{mod:part:source1} y_{1s}^s & = 1  & s\in S,\\
%\label{mod:part:noReturn} y^u_{ij}+y^v_{lj} &\leq 1 & i\in I,l\in C(i), j\in J, u\in V_\alpha,v\in V,\\
\label{mod:part:followArcs} y^u_{is}+y^v_{ls} &\leq 1 & i\in I,l\in C(i), s\in S, u,v\in V',(u,v)\not\in A',\\
\label{mod:part:dim}&&y \in \{0,1\}^{I\times S\times V'}.
\end{align}~
\end{subequations}

As the model solves the decision problem, it suffices to find any feasible solution, and no objective function is needed.
The interpretation of constraints \eqref{mod:part:nodeBelongs} is that every node in the extended graph $G'$ belongs to exactly one binomial tree.
By \eqref{mod:part:treeHasIJ} is ensured that there is always exactly one $i$-th node of each binomial tree.
Next, \eqref{mod:part:source1} enforce that source nodes are the first nodes in corresponding binomial trees, in accordance with definition of the mapping $\beta$.
The remaining constraints \eqref{mod:part:followArcs} guarantee that the arcs of binomial trees follow arcs in $A'$.
The definition of $A'$ also prevents arcs of the binomial trees to be oriented from $V_\alpha$ to $V$.
In other words, once the signal leaves the original graph $G$ and enters $K_\alpha$, it cannot return back to $G$.
Without this requirement, it could be possible to find a partition of $G'$ into binomial trees, even though no partition of $G$ into truncated binomial trees exists.

\subsection{Lower bounds}
In this section, we present several lower bounding techniques. 
An optimal solution is obtained by solving a sequence of decision problems with varying delay $k$. 
It is therefore useful to determine tight lower and upper bounds in order to arrive in the optimum after solving as few decision problems as possible.
Obvious bounds for a general graph instance are given by
\begin{observation}
For an instance (G,S) of Problem \ref{prob:min},
$$\left\lceil\log\frac{n}{s}\right\rceil\leq k \leq n-s.$$
\end{observation}
These bounds can be tightened after exploiting the input graph properties. 
We aim to investigate bounds for various graph classes.

%\begin{acknowledgements}
%If you'd like to thank anyone, place your comments here
%and remove the percent signs.
%\end{acknowledgements}

% BibTeX users please use one of
%\bibliographystyle{spbasic}      % basic style, author-year citations
%\bibliographystyle{spmpsci}      % mathematics and physical sciences
%\bibliographystyle{spphys}       % APS-like style for physics
%\bibliography{}   % name your BibTeX data base

% Non-BibTeX users please use
\begin{thebibliography}{}
%
% and use \bibitem to create references. Consult the Instructions
% for authors for reference list style.
%
\bibitem{chu17}
Chu, X., Chen, Y.,
Time division inter‚Äêsatellite link topology generation problem: Modeling and solution,
International Journal of Satellite Communications and Networking, 194 -- 206, 36 (2017)

\bibitem{janseni95}
Jansen, K., M\"uller, H.,
The minimum broadcast time problem for several processor networks, 
Theoretical Computer Science, 69 -- 85, 147 (1995)

\bibitem{middendorf93}
Middendorf, M.,
Minimum broadcast time is NP-complete for 3-regular planar graphs and deadline 2,
Information Processing Letters, 281 -- 287, 46 (1993)

% Format for Journal Reference
%Author, Article title, Journal, Volume, page numbers (year)
% Format for books
%\bibitem{RefB}
%Author, Book title, page numbers. Publisher, place (year)
% etc
\end{thebibliography}

\end{document}
% end of file template.tex

