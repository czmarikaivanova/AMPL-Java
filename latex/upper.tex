\section{Upper bounds}

We present a simple general method for determining an upper bound on the optimal solution.
The idea is to construct broadcast trees in parallel from their roots in sources.
A new node is connected to a tree is it was not connected to any other tree in any of the previous iterations.
The steps are summarized in Alg. \ref{alg:genub}.

\begin{algorithm}[]
\KwData{$G=(V,E), S\subseteq V$}
$U\leftarrow S$;\tcp{Set of marked nodes}
$T_s=(V_s,A_s), V_s\leftarrow \{s\}, E_s\leftarrow\emptyset$\;
\While{$|U|<n$} {
	\For{$s\in S$} {
		Select $v\in V\setminus U:\exists u\in V_s \text{ s. t.} \{u,v\}\in E$ according to some strategy\; 	
		$U\leftarrow U\cup\{v\}$\;
		$V_s\leftarrow V_s\cup\{v\}$\;
		$A_s\leftarrow A_s\cup\{u,v\}$\;
	}
}
\For{$s\in S$} {
$	
\sigma(v)=\begin{cases}
		0, \text{ if } v\in L(T_s),\\
		\max\limits_{k\in 1,\dots,|N^+(v)|}\{k+\sigma(j_k):j_k\in N^+(v)\wedge \forall \ell<k:\sigma(j_\ell)>\sigma(j_k)\},\\
		\hfill \text{ if }v\in V_s\setminus L(T_s).

\end{cases}\;
$
}
\Return $\max_{s\in S}\sigma(s)$\;
%\Return $\lceil k/s \rceil$\;
 \caption{A method for determining an upper bound}
\label{alg:genub}
\end{algorithm}
The algorithm consists of two phases. 
In the first phase (lines 3 -- 10), $m$ broadcast trees are constructed.
The second phase (lines 11 -- 13) uses a recursive formula that determines in linear time an optimal broadcast time for a subtree of $T_s$ rooted at $v\in V_s$.
The value  $\sigma(s)$ than gives the optimal broadcast time for $T_s$.
The complexity of Alg. \ref{alg:genub} depends on the strategy according to which the trees are constructed.
For common strategies such as BFS and DFS it is $\mathcal{O}(n+|E|)$, for the shortest paths trees $\mathcal{O}(|E| + n\log n)$.


